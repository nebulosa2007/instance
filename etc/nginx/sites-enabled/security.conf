        # Block large requests
        client_max_body_size 10M;

        # Hide nginx version
        server_tokens off;

        # Protection against Slowloris attacks
        client_body_timeout 10s;
        client_header_timeout 10s;

        # Block malicious User-Agents
        if ($http_user_agent ~* (python-requests|libredtail-http|l9explore|l9tcpid|zgrab|CensysInspect|CyberOKInspect|NetcraftSurveyAgent|xfa1|ivre-masscan|WanScannerBot|Keydrop\.io|masscan|nikto|sqlmap|nmap) ) {
            return 444;
        }

        # Block empty User-Agents
        if ($http_user_agent = "-" ) {
            return 444;
        }

        # Block binary data in requests
        if ($request_uri ~ [\x00-\x08\x0B-\x0C\x0E-\x1F\x7F]) {
            return 400;
        }

        # Limit HTTP methods
        if ($request_method !~ ^(GET|HEAD|POST)$ ) {
            return 405;
        }

        # Block CONNECT method
        if ($request_method = CONNECT) {
            return 405;
        }

        # Protection against path traversal
        location ~ \.\./ {
            deny all;
            return 400;
        }

        location ~ /\.\./ {
            deny all;
            return 400;
        }

        # Block access to hidden files and configurations
        location ~ /\.(env|git|ht|htaccess|svn) {
            deny all;
            return 404;
        }

        location ~* \.(bak|config|sql|old|save|swp|backup|bkp)$ {
            deny all;
            return 404;
        }

        # Block access to administrative panels
        location ~* ^/(admin|manager|login|config|phpunit|vendor|\.git|wp-admin) {
            deny all;
            return 404;
        }

        # Block CGI exploits
        location ~* ^/cgi-bin/ {
            deny all;
            return 404;
        }

        # Rate limiting for all requests
        location / {
            limit_req zone=security burst=20 nodelay;
            try_files $uri $uri/ =404;
        }

        # Stricter rate limiting for API endpoints
        location ~* ^/(api|login|auth) {
            limit_req zone=api burst=10 nodelay;
        }
